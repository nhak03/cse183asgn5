[[extend 'layout.html']]
<style>
  [v-cloak] {
       display: none;
  }
  </style>

<div class="section" id="app" v-cloak>
  <!-- Put here your Vue.js template -->
  <div class="container">
    <h1 class="title">Contacts</h1>
    <div><button class="button is-success" id="add_button" @click="addContact">Add Contact</button></div>
    <!-- Render the contacts -->>
    <div class="contact" v-for="contact in contacts" :key="contact.card_id">
      <div class="card-content">
        <div class="media">
          <div class="media-left">
            <figure class="photo image is-96x96" @click="editImage(contact)">
              <img class="photo" :src="contact.contact_image ? 'data:image/png;base64,' + contact.contact_image : 'https://bulma.io/assets/images/placeholders/96x96.png'"/>
              <input id="file-input" type="file" style="display: none"
              accept=".jpg, .png, .jpeg, .gif, .bmp, .tif, .tiff|image/*">
            </figure>
          </div>
          <div class="media-content">
            <p class="title person-name">
              <input type="text" class="input is-4 title" 
                    name="name"
                    v-model="contact.contact_name"
                    placeholder="Name"
                    :readonly="!contact.isNameEditing"
                    @focus="contact.isNameEditing = true"
                    @input="setEditFunction($event, 'editContactName', contact)"
                    @blur="set_val_on_blur($event); editContactName(contact); contact.isNameEditing = false"
              />
            </p>
            <p class="subtitle person-affiliation">
              <input type="text" class="input is-6" 
                    placeholder="Affiliation"
                    name="affiliation"
                    v-model="contact.contact_affiliation"
                    @blur="set_val_on_blur($event); editContactAffiliation(contact); contact.isAffiliationEditing = false"
                    :readonly="!contact.isAffiliationEditing"
                    @focus="contact.isAffiliationEditing = true"
                    @input="setEditFunction($event, 'editContactAffiliation', contact)"
              />
            </p>
          </div>
          <div class="media-right"><i class="delete-button has-text-danger fa-solid fa-trash-can trash" @click="deleteContact(contact)"></i></div>
        </div>
          <textarea class="textarea"
                    name="description"
                    placeholder="Description"
                    v-model="contact.contact_description"
                    @blur="set_val_on_blur($event); editDescription(contact); contact.isDescriptionEditing = false"
                    :readonly="!contact.isDescriptionEditing"
                    @focus="contact.isDescriptionEditing = true"
                    @input="setEditFunction($event, 'editDescription', contact)"
            ></textarea> 
        </div>
      </div>
    </div>
  </div>
</div>

[[block page_scripts]]
<script>
  let get_home_url = "[[=XML(get_home_url)]]";
</script>
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.8/axios.min.js"></script>
<script src="js/index.js"></script>
[[end]]
